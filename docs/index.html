<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Uma Builder â€” Card Picker</title>
<style>
:root {
  --card-w: 118px;
  --gap: 10px;
}

body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
  padding: 0;
  width: 100%;
  background: #fff;
  color: #111;
  display: flex;
  justify-content: center;
}

.container {
  display: flex;
  gap: 20px;
  padding: 24px;
  width: auto;
}

.sidebar {
  flex-shrink: 0;
  width: 200px;
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.filter-group label {
  font-weight: 700;
  margin-bottom: 6px;
  display: block;
  font-size: 14px;
}

select, input.skill-search {
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
  width: 100%;
  font-size: 14px;
}

.main-content {
  display: inline-flex;
  flex-direction: column;
  align-items: flex-start;
  width: calc((var(--card-w) + var(--gap)) * 6 - var(--gap));
}

.slots-header {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 8px;
  width: 100%;
}

.clear-all {
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
  border: none;
  border-radius: 6px;
  background: #444;
  color: #fff;
}

.slots {
  display: grid;
  grid-template-columns: repeat(6, var(--card-w));
  gap: var(--gap);
  margin-bottom: 18px;
  width: calc((var(--card-w) + var(--gap)) * 6 - var(--gap));
}

.slot, .card {
  border: 1px solid #ddd;
  padding: 8px;
  box-sizing: border-box;
  background: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  width: var(--card-w);
  min-height: 490px;
  position: relative;
}

.slot:not(.has-card) {
  border: 2px dashed #ccc;
  background: #fafafa;
}

.slot .placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #ccc;
  font-size: 12px;
}

.slot .name, .card .name {
  margin: 8px 0 6px 0;
  font-weight: 700;
  text-align: center;
  font-size: 12px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.slot .skills, .card .skills,
.slot .skills-group, .card .skills-group {
  display: flex;
  flex-direction: column;
  gap: 6px;
  width: 100%;
  align-items: center;
}

.slot .skill, .card .skill {
  width: 100%;
  background: #eef2ff;
  border-radius: 6px;
  padding: 4px 6px;
  font-size: 10px;
  text-align: center;
  word-break: break-word;
}

.slot img, .card img {
  max-width: 100%;
  max-height: 100px;
  object-fit: contain;
}

.slot .type-icon, .card .type-icon {
  position: absolute;
  top: 6px;
  right: 6px;
  width: 20px;
  height: 20px;
  border: 1px solid #ccc;
  background: #fff;
  border-radius: 4px;
  overflow: hidden;
  text-align: center;
  font-size: 10px;
  line-height: 18px;
  font-weight: bold;
}

.card.disabled {
  opacity: 0.45;
}

.skills-header {
  font-weight: bold;
  font-size: 10px;
  color: #444;
  margin-bottom: 2px;
  text-align: center;
}

.card-sections,
.card-section {
  width: calc((var(--card-w) + var(--gap)) * 6 - var(--gap));
}

.card-section {
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

.card-section h2 {
  margin: 0 0 6px 0;
  font-size: 16px;
}

.card-grid-wrapper {
  display: inline-block;
  position: relative;
}

.cards {
  display: grid;
  grid-template-columns: repeat(6, var(--card-w));
  gap: var(--gap);
}

.page-controls {
  position: absolute;
  top: -24px;
  right: 0;
  display: flex;
  gap: 6px;
  align-items: center;
}

.page-controls button {
  border: none;
  border-radius: 6px;
  background: #444;
  color: #fff;
  padding: 4px 8px;
  opacity: 0.4;
  pointer-events: none;
  height: auto;
}

.skill-search-header {
  background: #b30000;
  color: #fff;
  padding: 6px 10px;
  border-radius: 6px;
  margin: 0 0 8px 0;
  font-size: 16px;
  font-weight: bold;
}

.skill.highlighted {
  background: #b30000 !important;
  color: #fff !important;
}

@media (max-width: 1100px) {
  :root { --card-w: 100px; }
}
</style>
</head>
<body>

<div class="container">
  <div class="sidebar">
    <div class="filter-group">
      <label for="racecourse">Racecourse</label>
      <select id="racecourse"><option value="">-- Select --</option>
        <option>Sapporo</option><option>Hakodate</option><option>Niigata</option><option>Fukushima</option>
        <option>Nakayama</option><option>Tokyo</option><option>Chukyo</option><option>Kyoto</option>
        <option>Hanshin</option><option>Kokura</option><option>Oi</option><option>Kawasaki</option>
        <option>Funabashi</option><option>Morioka</option><option>Longchamp</option>
      </select>
    </div>
    <div class="filter-group"><label for="length">Length</label>
      <select id="length"><option value="">-- Select --</option>
        <option value="1000">1000m</option><option value="1150">1150m</option><option value="1200">1200m</option>
        <option value="1300">1300m</option><option value="1400">1400m</option><option value="1500">1500m</option>
        <option value="1600">1600m</option><option value="1700">1700m</option><option value="1800">1800m</option>
        <option value="1900">1900m</option><option value="2000">2000m</option><option value="2100">2100m</option>
        <option value="2200">2200m</option><option value="2300">2300m</option><option value="2400">2400m</option>
        <option value="2500">2500m</option><option value="2600">2600m</option><option value="3000">3000m</option>
        <option value="3200">3200m</option><option value="3400">3400m</option><option value="3600">3600m</option>
      </select>
    </div>
    <div class="filter-group"><label for="direction">Direction</label>
      <select id="direction"><option value="">-- Select --</option>
        <option>Clockwise</option><option>Counterclockwise</option>
      </select>
    </div>
    <div class="filter-group"><label for="track">Track Conditions</label>
      <select id="track"><option value="">-- Select --</option>
        <option>Firm</option><option>Good</option><option>Soft</option><option>Heavy</option>
      </select>
    </div>
    <div class="filter-group"><label for="season">Season</label>
      <select id="season"><option value="">-- Select --</option>
        <option>Spring</option><option>Summer</option><option>Autumn</option><option>Winter</option>
      </select>
    </div>
    <div class="filter-group"><label for="weather">Weather</label>
      <select id="weather"><option value="">-- Select --</option>
        <option>Sunny</option><option>Cloudy</option><option>Rainy</option><option>Snowy</option>
      </select>
    </div>
    <div class="filter-group"><label for="strategy">Strategy</label>
      <select id="strategy"><option value="">-- Select --</option>
        <option>Front</option><option>Mid</option><option>Back</option>
      </select>
    </div>
    <button class="clear-all">Clear All Filters</button>
  </div>

  <div class="main-content">
    <div class="slots-header">
      <button class="clear-all">Clear Slots</button>
    </div>
    <div class="slots" id="slots">
      <div class="slot" data-slot="0"><div class="placeholder">Empty Slot</div></div>
      <div class="slot" data-slot="1"><div class="placeholder">Empty Slot</div></div>
      <div class="slot" data-slot="2"><div class="placeholder">Empty Slot</div></div>
      <div class="slot" data-slot="3"><div class="placeholder">Empty Slot</div></div>
      <div class="slot" data-slot="4"><div class="placeholder">Empty Slot</div></div>
      <div class="slot" data-slot="5"><div class="placeholder">Empty Slot</div></div>
    </div>

    <div class="card-sections">
      <div class="card-section skill-search-section">
        <div class="skill-search-header">Skill Search</div>
        <input type="text" placeholder="Search Skills..." class="skill-search" id="skillSearch">
      </div>
      <div class="card-grid-wrapper">
        <div class="cards" id="cards">
          <!-- Cards dynamically populated -->
        </div>
        <div class="page-controls">
          <button id="prevPage">Prev</button>
          <button id="nextPage">Next</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ---------- DATA ----------
let allCards = []; // load your JSON cards here
const slotsEl = document.getElementById('slots');
const cardsEl = document.getElementById('cards');
let selectedCards = new Set();
let currentPage = 0;
const pageSize = 12;

// ---------- UTIL ----------
function normalizeSkill(s){ return s.trim().toLowerCase(); }
function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }

// ---------- RENDER ----------
function renderSlots(){
  const slots = slotsEl.querySelectorAll('.slot');
  slots.forEach(slot=>{
    const index = slot.dataset.slot;
    const card = Array.from(selectedCards)[index];
    slot.innerHTML = '';
    if(card){
      slot.classList.add('has-card');
      slot.innerHTML = `<div class="name">${card.name}</div>
        <img src="${card.image}" alt="${card.name}">
        <div class="skills">${card.skills.map(s=>`<div class="skill">${s}</div>`).join('')}</div>`;
    } else {
      slot.classList.remove('has-card');
      slot.innerHTML = '<div class="placeholder">Empty Slot</div>';
    }
  });
}

function renderCards(filteredCards){
  const start = currentPage*pageSize;
  const pageCards = filteredCards.slice(start, start+pageSize);
  cardsEl.innerHTML = '';
  pageCards.forEach(card=>{
    const isDisabled = Array.from(selectedCards).some(c=>c.id===card.id && c!==card);
    const cardEl = document.createElement('div');
    cardEl.className = 'card' + (isDisabled?' disabled':'');
    cardEl.innerHTML = `<div class="name">${card.name}</div>
      <img src="${card.image}" alt="${card.name}">
      <div class="skills">${card.skills.map(s=>`<div class="skill">${s}</div>`).join('')}</div>`;
    if(!isDisabled) cardEl.onclick = ()=>addCardToSlot(card);
    cardsEl.appendChild(cardEl);
  });
}

function addCardToSlot(card){
  if(selectedCards.has(card)) return;
  const emptySlot = Array.from(slotsEl.querySelectorAll('.slot')).find(s=>!s.classList.contains('has-card'));
  if(!emptySlot) return;
  selectedCards.add(card);
  renderSlots();
  applySkillHighlights();
  renderCards(applyFilters());
}

// ---------- FILTERS ----------
function applyFilters(){
  const racecourse = document.getElementById('racecourse').value;
  const length = document.getElementById('length').value;
  const direction = document.getElementById('direction').value;
  const track = document.getElementById('track').value;
  const season = document.getElementById('season').value;
  const weather = document.getElementById('weather').value;
  const strategy = document.getElementById('strategy').value;

  return allCards.filter(card=>{
    if(racecourse && card.racecourse!==racecourse) return false;
    if(length && card.length!==parseInt(length)) return false;
    if(direction && card.direction!==direction) return false;
    if(track && card.track!==track) return false;
    if(season && card.season!==season) return false;
    if(weather && card.weather!==weather) return false;
    if(strategy && card.strategy!==strategy) return false;
    return true;
  });
}

document.querySelectorAll('.sidebar select').forEach(sel=>{
  sel.onchange = ()=>{currentPage=0; renderCards(applyFilters()); applySkillHighlights();}
});
document.querySelectorAll('.clear-all').forEach(btn=>{
  btn.onclick = ()=>{
    selectedCards.clear();
    renderSlots();
    document.querySelectorAll('.sidebar select').forEach(sel=>sel.value='');
    document.getElementById('skillSearch').value='';
    currentPage=0;
    renderCards(allCards);
    applySkillHighlights();
  };
});

// ---------- PAGINATION ----------
document.getElementById('prevPage').onclick = ()=>{if(currentPage>0){currentPage--; renderCards(applyFilters());}};
document.getElementById('nextPage').onclick = ()=>{
  if((currentPage+1)*pageSize<applyFilters().length){currentPage++; renderCards(applyFilters());}
};

// ---------- SKILL SEARCH ----------
document.getElementById('skillSearch').oninput = (e)=>{
  const term = normalizeSkill(e.target.value);
  if(!term){ renderCards(applyFilters()); return; }
  const filtered = allCards.filter(c=>c.skills.some(s=>normalizeSkill(s).includes(term)));
  currentPage=0;
  renderCards(filtered);
  applySkillHighlights(term);
};

// ---------- HIGHLIGHTS ----------
function applySkillHighlights(term=''){
  const skillsEls = document.querySelectorAll('.skill');
  skillsEls.forEach(s=>s.classList.remove('highlighted'));
  if(term){
    skillsEls.forEach(s=>{
      if(normalizeSkill(s.textContent).includes(term)) s.classList.add('highlighted');
    });
  }
}

// ---------- INIT ----------
renderCards(allCards);
renderSlots();
</script>

</body>
</html>
